# SS_6_securityprotocol_TLS

```
Secure Socket Layer/Transport Layer Security
Transport Layer Security
TLS Handshake protocol
TLS version 1.3
Case Study of JAVA SSL
```



## Secure Socket Layer (SSL)

λ³΄μ• μ†μΌ“ λ μ΄μ–΄λ” λ°μ΄ν„° ν†µμ‹ μ„ μ•”νΈν™”ν•κ³  λ³΄νΈν•κΈ° μ„ν• ν”„λ΅ν† μ½κ³Ό κΈ°μ μ μ§‘ν•©μ΄λ‹¤.

μ£Όλ΅ μ›Ή μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κ°„μ ν†µμ‹ μ—μ„ μ‚¬μ©λλ©° μΈν„°λ„· μƒμ—μ„ λ°μ΄ν„°μ μ•μ „ν• μ „μ†΅μ„ μ„ν• ν•µμ‹¬ λ³΄μ• λ©”μ»¤λ‹μ¦ μ¤‘ ν•λ‚μ΄λ‹¤.

- μ „μ†΅ κ³„μΈµ λ³΄μ• μ„λΉ„μ¤
- μ›λλ” λ„·μ¤μΌ€μ΄ν”„μ—μ„ κ°λ°λ¨, λ²„μ „3μ€ κ³µκ°μκ²¬μ„ λ°μν•΄ μ„¤κ³„λ¨
- μ‹ λΆ°ν•  μ μλ” end-to-end μ„λΉ„μ¤λ¥Ό μ κ³µν•κΈ° μ„ν•΄ TCPλ¥Ό μ‚¬μ©ν•λ‹¤.
- SSLμ€ λ‘ κ°μ ν”„λ΅ν† μ½ λ μ΄μ–΄λ¥Ό κ°€μ§€κ³  μλ‹¤.
- μ΄ν›„μ—λ” TLS(μ „μ†΅ κ³„μΈµ λ³΄μ•)μΌλ΅ μ•λ ¤μ§„ μΈν„°λ„· ν‘μ¤€μ΄ λμ—λ‹¤.




## Transport Layer Security(TLS)β›„

μ „μ†΅ κ³„μΈµ λ³΄μ•μ€ SSL λ²„μ „ 3.1λ΅λ¶€ν„° λ°μ „ν• κ²ƒμ΄λ‹¤. SSLv3κ³Ό μ μ‚¬ν• κµ¬μ΅°λ¥Ό κ°€μ§€μ§€λ§ μΌλ¶€ μ°¨μ΄κ°€ μλ‹¤.

- λ μ½”λ“ ν•μ‹μ λ²„μ „ λ²νΈμ—μ„μ μ°¨μ΄ : TLSμ—μ„λ” λ μ½”λ“ ν•μ‹μ λ²„μ „ λ²νΈκ°€ λ‹¤λ¥΄λ‹¤.
- MACλ΅ HMAC μ‚¬μ© (λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦μ— μ‚¬μ©)
- μ•”νΈν™” ν‚¤λ¥Ό ν™•μ¥ν•λ”λ° μμ‚¬ λλ¤ ν•¨μλ¥Ό μ‚¬μ©
- μ¶”κ°€ κ²½κ³  μ½”λ“ λ„μ…, ν†µμ‹  λ„μ¤‘ λ°μƒν• λ¬Έμ μ— λ€ν• μ •λ³΄ λ” μƒμ„Έν μ κ³µ
- μ•”νΈν™” λ° μΈμ¦ λ°©μ‹ λ³€κ²½, λ” κ°•λ ¥ν• λ³΄μ• μ κ³µ



## TLS μ•„ν‚¤ν…μ²β›„

![image](https://github.com/hhzzzk/studyLog/assets/67236054/719677fc-a90e-4ae7-8097-354cab647d6d)

**Handshake Protocol**

- TLS μ—°κ²°μ€ ν•Έλ“μ…°μ΄νΈ ν”„λ΅ν† μ½μ„ ν†µν•΄ μ‹μ‘ν•λ‹¤. μ—¬κΈ°μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μ΄κΈ° ν†µμ‹  μ΄λ¤„μ§„λ‹¤.
- ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ—κ² μ•μ „ν• μ—°κ²°μ„ μ„¤μ •ν•κ³  μ”μ²­ν•λ‹¤. μΌλ°μ μΌλ΅ HTTPSμ—μ„ λ°μƒν•λ‹¤.
- μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μλ½ν•κ³  μ„λ²„μ λ””μ§€ν„Έ μΈμ¦μ„(μ„λ²„μ κ³µκ°ν‚¤μ™€ μΈμ¦μ •λ³΄)λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— μ κ³µν•λ‹¤.
- ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μƒνΈ μΈμ¦μ„ μν–‰ν•λ©° μ„λ΅μ μ‹ μ›μ„ ν™•μΈν•λ‹¤. == μ¤‘κ°„μ κ³µκ²© λ°©μ§€
- ν•Έλ“μ…°μ΄ν¬ κ³Όμ •μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ μ„Έμ… ν‚¤λ¥Ό κµν™ν•μ—¬ μ΄ν›„ λ°μ΄ν„° ν†µμ‹ μ„ μ•”νΈν™”ν•λ‹¤.

**TLS Record Protocol**

- ν•Έλ“μ…°μ΄ν¬ ν›„ μ‹¤μ  λ°μ΄ν„° μ „μ†΅μ€ λ μ½”λ“ ν”„λ΅ν† μ½μ„ ν†µν•΄ μ΄λ¤„μ§„λ‹¤.
- λ μ½”λ“ ν”„λ΅ν† μ½μ€ λ°μ΄ν„°μ μ•”νΈν™”, λ¬΄κ²°μ„± κ²€μ‚¬, λ³µνΈν™” λ° λ°μ΄ν„° μ••μ¶•μ„ μ²λ¦¬ν•λ‹¤.
- λ°μ΄ν„°λ” λ μ½”λ“λ΅ λ¶„ν• λμ–΄ μ „μ†΅λλ©° μ΄λ¬ν• λ μ½”λ“λ” μ•”νΈν™” λ° λ³µνΈν™”λλ©° λ¬΄κ²°μ„±μ„ ν™•μΈν•λ”λ° μ‚¬μ©λλ‹¤.



## TLS ν”„λ΅ν† μ½μ νΉμ§•β›„

- TCP(μ „μ†΅ μ μ–΄ ν”„λ΅ν† μ½)μ„μ—μ„ μ‘λ™ν•λ‹¤.

  - TCPλ” μ•μ •μ μ΄κ³  μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅μ„ λ‹΄λ‹Ήν•μ—¬ TLSλ” μ΄λ¥Ό ν†µν•΄ λ°μ΄ν„°μ λ³΄μ•μ„±μ„ μ¶”κ°€ν•λ‹¤.

- TLSλ” μμ²΄ λ‹¨μ„μΈ **λ μ½”λ“**λ¥Ό μ‚¬μ©ν•λ‹¤.

  - λ μ½”λ“λ” ν—¤λ”μ™€ νμ΄λ΅λ“λ΅ κµ¬μ„±λλ‹¤. ν—¤λ”μ—λ” λ μ½”λ“μ ν•κ³Ό κΈΈμ΄ μ •λ³΄κ°€ ν¬ν•¨λλ©° νμ΄λ΅λ“μ—λ” μ‹¤μ  λ°μ΄ν„° λλ” λ©”μ‹μ§€κ°€ ν¬ν•¨λλ‹¤.

  - ### λ μ½”λ“μ 4κ°€μ§€ μ ν•

    1. μ‚¬μ©μ λ°μ΄ν„° : μ‹¤μ  μ•± λ°μ΄ν„°λ¥Ό λ‚νƒ€λ‚΄λ©° μ‚¬μ©μμ™€ μ„λ²„κ°„μ μ‹¤μ  μ •λ³΄ κµν™μ— μ‚¬μ©λλ‹¤.
    2. ν•Έλ“μ…°μ΄ν¬ λ©”μ‹μ§€ : ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ—μ„ μ‚¬μ©λλ” λ©”μ‹μ§€κ°€ ν¬ν•¨λ λ μ½”λ“
    3. κ²½κ³  : TLSμ—μ„λ” μ„λ΅μ—κ² κ²½κ³  λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ³  λ°›μ„ μ μλ‹¤. μ—°κ²° λκΉ€, λ°μ΄ν„° λ¬΄κ²°μ„± μ„λ° λ“±
    4. μ•”νΈ λ…μ„Έ λ³€κ²½ Change cipher spec : λ°μ΄ν„° μ „μ†΅μ— μ‚¬μ©λλ” μ•”νΈ λ…μ„Έ λ³€κ²½μ„ λ‚νƒ€λ‚Έλ‹¤.μ΄λ” μ‹¤μ  λ°μ΄ν„° μ•”νΈν™”λ¥Ό ν™μ„±ν™”ν•κ±°λ‚ λΉ„ν™μ„±ν™”ν•λ” λ° μ‚¬μ©λλ‹¤.



## TLS sessionβ›„

TLS μ„Έμ…μ€ TLS ν”„λ΅ν† μ½μ„ μ‚¬μ©ν•μ—¬ ν†µμ‹ ν•λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ μ—°κ²°μ„ λ‚νƒ€λ‚Έλ‹¤. 

λ„¤νΈμ›ν¬ μƒμ—μ„ μΌλ ¨μ TLSμ—°κ²°μ„ κ΄€λ¦¬, λ‹¤μ–‘ν• λ³΄μ• λ§¤κ°λ³€μμ™€ μ •λ³΄λ¥Ό μ €μ¥ν•λ‹¤.

- ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ— μν•΄ μƒμ„±λλ‹¤.
- μ•”νΈν™” μ•κ³ λ¦¬μ¦, μΈμ¦ λ°©λ²•, μ„Έμ… ν‚¤, λ””μ§€ν„° μΈμ¦μ„ λ° κΈ°νƒ€ λ³΄μ• λ§¤κ°λ³€μλ¥Ό μ €μ¥ν•λ‹¤.
  - μ΄λ¬ν• λ§¤κ°λ³€μλ” μ„Έμ… λ™μ• λ°μ΄ν„°μ μ•”νΈν™”μ™€ λ¬΄κ²°μ„±μ„ λ³΄νΈν•λ‹¤.
- μ—¬λ¬ κ°μ TLS μ—°κ²°μ—μ„ κ³µμ λ  μ μλ‹¤.
  - TLS μ„Έμ…μ€ μ¬μ‚¬μ©λ  μ μλ‹¤. 

β›„

## TLS λ³΄μ•

1. λ¬΄κ²°μ„±
   - TLSμ—μ„λ” λ©”μ‹μ§€ λ¬΄κ²°μ„±μ„ λ‹¬μ„±ν•κΈ° μ„ν•΄ HMACλ¥Ό μ‚¬μ©ν•λ‹¤.
2. κΈ°λ°€μ„±
   - TLSμ—μ„λ” ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ— μν•΄ μ •μλ κ³µμ  λΉ„λ°€ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ€μΉ­ μ•”νΈν™”λ¥Ό μν–‰ν•λ‹¤.
     - λ€μΉ­ μ•”νΈν™”λ” λ©”μ‹μ§€μ μ†΅μμ‹ μκ°€ κ°™μ€ λΉ„λ°€ν‚¤λ¥Ό κ³µμ ν•μ—¬ μ΄λ΅ μ•”νΈν™” λ³µνΈν™”ν•λ‹¤.
   - μ•”νΈν™” μ•κ³ λ¦¬μ¦μΌλ΅λ” AESλ‚ IDEAλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.
   - μ•”νΈν™” μ „μ— λ©”μ‹μ§€λ¥Ό μ••μ¶•ν•λ‹¤.

β›„

## SSL(TLS) Record Protocol Operation

![image](https://github.com/hhzzzk/studyLog/assets/67236054/c9d40e36-dfe5-491b-b659-fa654fe6d71d)

**Data** : TLS ν”„λ΅ν† μ½μ€ λ¨Όμ € μƒμ„ μμ¤€ λ°μ΄ν„°λ¥Ό λ°›λ”λ‹¤. μΌλ°μ μΈ μ›Ή λΈλΌμ°μ €μ™€ μ›Ή μ„λ²„ μ‚¬μ΄μ—μ„ μ „μ†΅λλ” μ›Ή νμ΄μ§€ λ‚΄μ© λ“±

**Fragment** : λ°μ΄ν„°λ” μ‘μ€ λΈ”λ­μΈ ν”„λκ·Έλ¨ΌνΈ λ‹¨μ„λ΅ λ¶„ν• λλ‹¤. 

**Compress** : ν”„λκ·Έλ¨ΌνΈκ°€ μ••μ¶•λλ‹¤.

**Add MAC** : λ°μ΄ν„° λΈ”λ­, ν”„λκ·Έλ¨ΌνΈμ— λ€ν• MACκ°€ μƒμ„±λλ‹¤. MACλ” λ°μ΄ν„°μ λ¬΄κ²°μ„± κ²€μ¦μ— μ‚¬μ©λλ‹¤.

**Encrypt** : μ•”νΈν™”, μƒμ„±λ MACμ™€ ν”„λκ·Έλ¨ΌνΈλ” κ³µμ λ λΉ„λ°€ ν‚¤λ¥Ό μ‚¬μ©ν•΄ λ€μΉ­ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ μ•”νΈν™”λλ‹¤. λ°μ΄ν„° κΈ°λ°€μ„±!

**SSL λ μ½”λ“ ν—¤λ” μ¶”κ°€** : μ•”νΈν™” λ° MACκ°€ μ μ©λ λ°μ΄ν„° λΈ”λ­μ— SSL λ μ½”λ“ ν—¤λ”κ°€ μ¶”κ°€λλ‹¤. μ΄ ν—¤λ”λ” λ°μ΄ν„°μ κΈΈμ΄μ™€ μ ν•μ„ μ‹λ³„ν•κ³  μ „μ†΅λ λ°μ΄ν„° λΈ”λ­μ΄ TLS ν”„λ΅ν† μ½λ΅ μ¬λ°”λ¥΄κ² μ²λ¦¬λλ„λ΅ λ•λ”λ‹¤.

β›„

## TLS Change Cipher Spec Protocol 

TLS λ³€κ²½ μ•”νΈ λ…μ„Έ ν”„λ΅ν† μ½

- TLS ν•Έλ“μ…°μ΄ν¬ κ³Όμ • μ¤‘μ νΉμ • λ©”μ‹μ§€μ΄λ‹¤. μ΄ λ©”μ‹μ§€κ°€ λ³΄λ‚΄μ§€λ©΄ μ•”νΈν™” μ¤μ„νΈ ν‚¤κ°€ λ³€κ²½λμ–΄ ν†µμ‹ μ΄ μ•”νΈν™”λλ‹¤. μ΄λ” ν•Έλ“μ…°μ΄ν¬ κ³Όμ •μ—μ„ ν‘μλ μ•”νΈ μ„¤μ •μ„ ν™μ„±ν™”μ‹ν‚¤λ” μ—­ν• μ„ ν•λ‹¤. 



## TLS Alert protocol

TLS κ²½κ³  ν”„λ΅ν† μ½

- TLS κ΄€λ ¨ κ²½κ³ λ¥Ό μƒλ€μ—κ² μ „λ‹¬ν•λ‹¤. κ²½κ³ λ” 2κ°€μ§€κ°€ μλ‹¤.
- μΉλ…μ  κ²½κ³  : μμƒμΉ λ»ν• λ©”μ„Έμ§€, μλ»λ λ μ½”λ“ MAC, μ••μ¶• ν•΄μ  μ‹¤ν¨, ν•Έλ“μ…°μ΄ν¬ μ‹¤ν¨ λ“±
- κ²½κ³  : μ—°κ²° μΆ…λ£ μ•λ¦Ό, μΈμ¦μ„ μ—†μ, μλ»λ μΈμ¦μ„, μΈμ¦μ„ νμ§€, μΈμ¦μ„ λ§λ£ λ“±

β›„

β›„

β›„

β›„

β›„

## TLS Handshake Protocol 

TLS μ—°κ²° μ„¤μ •μ„ μ„ν•΄ μ‚¬μ©λλ‹¤. μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ λ‹¤μκ³Ό κ°™μ€ μ‘μ—…μ„ μν–‰ν•κ² ν•λ‹¤.

- μ„λ΅ μΈμ¦
- μ•”νΈν™” λ° HMAC μ•κ³ λ¦¬μ¦ ν‘μƒ
- μ‚¬μ©λ  μ•”νΈν™” ν‚¤ ν‘μƒ

λ‹¨κ³„

1. λ³΄μ• κΈ°λ¥ μ„¤μ •
2. μ„λ²„ μΈμ¦ λ° ν‚¤ κµν™
3. ν΄λΌμ΄μ–ΈνΈ μΈμ¦ λ° ν‚¤ κµν™

![](https://velog.velcdn.com/images/vpdrnls/post/9cb2f7a0-b521-46d1-92ff-ecd725e64b77/image.png)

### π•client_helloπ•

TLS ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ μ²« λ²μ§Έ λ©”μ‹μ§€λ΅, TLS μ—°κ²° μ„¤μ • κ³Όμ •μ—μ„ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² λ³΄λ‚΄λ” λ©”μ„Έμ§€μ΄λ‹¤.

β€‹	**λ©”μ„Έμ§€μ— ν¬ν•¨λλ” λ‚΄μ©**

- λ²„μ „ : ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ© κ°€λ¥ν• TLS λ²„μ „ λ²”μ„
- λ¬΄μ‘μ„ λ²νΈ : λ³΄μ• μ„Έμ…ν‚¤ μƒμ„±μ— μ‚¬μ©.
- μ„Έμ…ID : ν΄λΌμ™€ μ„λ²„ μ‚¬μ΄μ μ΄μ „ μ„Έμ…μ„ μ¬μ‚¬μ©ν•λ ¤λ” κ²½μ° ν•΄λ‹Ή μ„Έμ… IDκ°€ μ—¬κΈ°μ— ν¬ν•¨λλ‹¤. μ΄λ¥Ό ν†µν•΄ μ΄μ „μ— μ„¤μ •λ μ—°κ²°μ μƒνƒλ¥Ό μ¬μ‚¬μ© κ°€λ¥ν•λ‹¤.
- μ•”νΈ μ¤μ„νΈ(Cipher Suite) : λ°μ΄ν„°μ λ³΄μ• λ° λ¬΄κ²°μ„±μ„ μ„ν• μ•”νΈ λ§¤κ°λ³€μλ¥Ό ν‘μ
  - ν΄λΌμ΄μ–ΈνΈκ°€ μ•”νΈν™” λ° HMAC μ•κ³ λ¦¬μ¦, ν‚¤ κµν™λ°©λ²• λ° λ‹¤λ¥Έ μ•”νΈ λ§¤κ°λ³€μλ¥Ό μ§€μ •ν•λ‹¤.

### π•server_helloπ•

μ„λ²„ ν—¬λ΅λ” TLS ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ λ‘λ²μ§Έ λ©”μ‹μ§€λ΅ ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² λ³΄λ‚Έ ν΄λΌμ΄μ–ΈνΈ ν—¬λ΅ λ©”μ‹μ§€μ— λ€ν• μ‘λ‹µμ΄λ‹¤. 

β€‹	**λ©”μ„Έμ§€μ— ν¬ν•¨λλ” λ‚΄μ©**

- μΈμ¦μ„ : μ„ νƒμ‚¬ν•­μ΄λ‹¤. μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² μμ‹ μ λ””μ§€ν„Έ μΈμ¦μ„λ¥Ό μ κ³µν•  λ• ν¬ν•¨ν•λ‹¤.
- λ¬΄μ‘μ„ λ²νΈ : ν΄λΌμ΄μ–ΈνΈμ²λΌ μ„λ²„λ„ λλ¤κ°’μ„ ν¬ν•¨ν•λ‹¤.
- μ„ νƒλ μ•”νΈ μ¤μ„νΈ : μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ— λ”°λΌ μ„ νƒν• μ•”νΈ μ¤μ„νΈκ°€ ν¬ν•¨λλ‹¤. 



### π•client_key_exchangedπ•

ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—κ² μ‚¬μ „ λ§μ¤ν„° ν‚¤(pre-master-key)λ¥Ό μ κ³µν•λ” λ©”μ„Έμ§€μ΄λ‹¤.

**μ‚¬μ „ λ§μ¤ν„° ν‚¤ S** : ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ™€ κ³µμ ν•  μ‚¬μ „ λ§μ¤ν„°ν‚¤ Sλ¥Ό ν¬ν•¨μ‹ν‚¨λ‹¤.

**λ§μ¤ν„°ν‚¤ K** : λ§μ¤ν„°ν‚¤λ” μ‚¬μ „ λ§μ¤ν„°ν‚¤, ν΄λΌμ΄μ–ΈνΈμ λ¬΄μ‘μ„κ°’ RAlice, μ„λ²„μ λ¬΄μ‘μ„κ°’ Rbob λ“±μ„ μ‚¬μ©ν•΄ ν•¨μ fμ— μν•΄ μƒμ„±λλ‹¤.  = f(S, RAlice, Rbob)

**λ§μ¤ν„° λΉ„λ°€** : λ§μ¤ν„°ν‚¤λ¥Ό κΈ°λ°μΌλ΅ λ§μ¤ν„° λΉ„λ°€μ΄ μƒμ„±λλ‹¤.

**μ—¬μ„― κ°μ μ„Έμ… ν‚¤** :  λ§μ¤ν„° λΉ„λ°€μ„ μ‚¬μ©ν•΄ μ—¬μ„― κ°μ μ„Έμ… ν‚¤κ°€ μƒμ„±λλ‹¤. K, RAlice, Rbobμ ν•΄μ‹ κ²°κ³Όλ΅ νμƒλλ‹¤.



### π•finishedπ•

TLS ν•Έλ“μ„Έμ΄ν¬μ λ§μ§€λ§‰ λ‹¨κ³„λ΅ ν†µμ‹ μ ν•Έλ“μ…°μ΄ν¬ κ³Όμ •μ΄ μ„±κ³µμ μΌλ΅ μ™„λ£λμ—μμ„ λ‚νƒ€λ‚΄λ” μ—­ν• μ„ ν•λ‹¤.

2κ°μ ν•΄μ‹κ°’μΌλ΅ κµ¬μ„±λλ‹¤.

1. **MD5**

   MD5(master_secret || pad2 || MD5(handshake_messages || sender || master_secret || pad1))

   - MD5 ν•΄μ‹ ν•¨μλ¥Ό μ‚¬μ©ν•΄ κ³„μ‚°λλ‹¤.
   - pad1 λ° pad2λ” μ •ν•΄μ§„ ν¨λ”© κ°’μ΄λ‹¤.
   - handshake_messagesλ” ν•Έλ“μ…°μ΄ν¬ λ©”μ‹μ§€μ ν•΄μ‹κ°’μ΄λ‹¤.
   - senderλ” ν΄λΌμ΄μ–ΈνΈ λλ” μ„λ²„μ μ—­ν• μ΄λ‹¤.

2. **SHA**

   SHA(master_secret || pad2 || SHA(handshake_messages || sender || master_secret || pad1))

   - SHA ν•΄μ‹ ν•¨μλ¥Ό μ‚¬μ©ν•΄ κ³„μ‚°λλ‹¤
   - MD5μ™€ λ°©μ‹μ€ λ™μΌν•λ‹¤.



## κΈ°νƒ€

- μΌλ°μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈλ” μ΄λ¦„κ³Ό μ•”νΈκ°€ κ°™μ€ μΈμ¦ μ •λ³΄λ¥Ό μ„λ²„λ΅ μ „μ†΅ν•΄ μ ‘κ·Όμ„ μ”μ²­ν•λ‹¤.
- ν•Έλ“μ…°μ΄ν¬ κ³Όμ • μ¤‘μ— μ„λ²„λ” "μΈμ¦μ„ μ”μ²­"μ„ λ©”μ‹μ§€2μ—μ„ ν΄λΌμ΄μ–ΈνΈμ—κ² λ³΄λ‚Ό μ μλ‹¤.
  - μ΄λ” μΈν„°λ„· λ±…ν‚Ήκ³Ό κ΄€λ ¨ μλ‹¤.

![](https://velog.velcdn.com/images/vpdrnls/post/0870e095-bc03-400d-aa5d-0281a6c1aa63/image.png)

20νμ΄μ§€